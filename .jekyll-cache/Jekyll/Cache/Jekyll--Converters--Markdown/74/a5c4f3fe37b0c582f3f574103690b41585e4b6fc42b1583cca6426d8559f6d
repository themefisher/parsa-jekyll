I"à+<p>Quando se trabalha com dados, principalmente de forma colaborativa, √© muito comum que as an√°lises e seus resultados sejam postos em um relat√≥rio a fim de documentar a rotina de trabalho, compartilhar o c√≥digo desenvolvido e comunicar os resultados obtidos. No R, em particular, isso facilmente pode ser feito por meio de um RMarkdown, um relat√≥rio din√¢mico poderoso em contar hist√≥rias a respeito de dados. Ao proporcionar reprodutibilidade, flexibilidade de formatos e sintaxe bastante simples, propagou-se entre os usu√°rios de R (com larga vantagem, obviamente) e tamb√©m entre aqueles que n√£o o s√£o - para ser ter uma ideia, √© poss√≠vel usar as linguagens Python, JavaScript e SQL em RMarkdown.</p>

<p>Intuitivamente, o ‚ÄúR‚Äù de RMarkdown vem da linguagem de programa√ß√£o R e o ‚ÄúMarkdown‚Äù est√° relacionado com a linguagem de marca√ß√£o do tipo <em>markdown</em>, que por sua vez informa apenas sobre a estrutura (conjunto de marca√ß√µes) do projeto. Logo, RMarkdown nada mais √© do que c√≥digos R (no caso em que a programa√ß√£o √© feita com R) incorporados em um arquivo <em>markdown</em>.</p>

<p>Adiante, vamos ver como o RMarkdown funciona em sua forma mais simples, por√©m sem deixar de dizer como ele deve ser minimamente estruturado.</p>

<p>Partindo do ponto que o R + RStudio j√° est√° instalado - caso n√£o, deixamos como sugest√£o a leitura do post <a href="https://observatorioobstetrico.github.io/r/programa√ß√£o/2019/04/14/Iniciando-no-R/">Iniciando na linguagem R</a> -, um arquivo RMarkdown (.Rmd) precisa ser criado. Para isso, v√° em <strong>File &gt; New File &gt; R Markdown‚Ä¶</strong>. A janela <strong>New R Markdown</strong> ser√° aberta. Nela, j√° podemos definir qual ser√° o t√≠tulo (em <strong>Title</strong>), o nome do autor (em <strong>Author</strong>) e o formato do arquivo (em <strong>Default Output Format</strong>). Em nosso exemplo, vamos criar um arquivo .Rmd em que o t√≠tulo √© <em>Ra√ßa das gestantes e pu√©rperas diagnosticadas com SRAG em 2021</em>, os autores s√£o estes que vos falam e HTML √© o tipo do arquivo que queremos que seja gerado. √â importante dizer que o RMarkdown exporta  diferentes formatos para al√©m desses exibidos como <em>default</em>.</p>

<p><img src="/assets/images/posts/Relat√≥rios-com-R-Markdown/fig1.png" alt="imagem" /></p>

<p>Ao clicar em <strong>OK</strong>, um arquivo .Rmd ser√° aberto no editor de <em>script</em> do RStudio com um roteiro pr√©-programado. Para n√£o haver confus√£o, apague tudo o que estiver abaixo do cabe√ßalho (mais precisamente, tudo o que estiver abaixo do segundo <code class="language-plaintext highlighter-rouge">---</code>) e salve o arquivo com o nome que julgar adequado. Ah, caso queira alterar o nome do t√≠tulo e/ou o nome dos autores que foram definidos anteriormente, n√£o tem problema, pode modific√°-los normalmente. Inclusive, pode excluir a data e o autor se achar que s√£o informa√ß√µes desnecess√°rias. O que n√£o pode √© deixar o arquivo sem o t√≠tulo e o <em>output</em>, informa√ß√µes indispens√°veis para que o RMarkdown funcione. Em nosso caso, vamos apenas remover a data.</p>

<p><img src="/assets/images/posts/Relat√≥rios-com-R-Markdown/fig2.png" alt="imagem" /></p>

<p>Como j√° deu para notar, √© no cabe√ßalho (tamb√©m conhecido como YAML) que est√£o as configura√ß√µes gerais do documento. A princ√≠pio, determinamos somente o t√≠tulo, o nome dos autores e o formato do arquivo de interesse. Mas podem ser definidas muitas outras informa√ß√µes, como √≠ndice, se√ß√µes, tema etc. Na <a href="https://bookdown.org/yihui/rmarkdown/html-document.html">documenta√ß√£o do RMarkdown para HTML</a> √© poss√≠vel ver com detalhes todas essas possibilidades.</p>

<p>Ap√≥s estabelecido o cabe√ßalho, √© a partir daqui que as marca√ß√µes de texto do <em>markdown</em> conjuntamente aos <em>chunks</em> come√ßam a ser bastante utilizados. As marca√ß√µes s√£o sintaxes que v√£o indicar o que s√£o desde t√≠tulos de se√ß√µes, t√≥picos e imagens a links, c√≥digos e express√µes matem√°ticas, por exemplo:</p>

<p>¬†‚Ä¢¬† o tamanho do t√≠tulo de uma se√ß√£o √© determinado pela quantidade de #, em que quanto menor a quantidade, maior o tamanho da fonte (varia de 1 a 5 <em>hashtags</em>);</p>

<p>¬†‚Ä¢¬† uma palavra em negrito deve estar entre <code class="language-plaintext highlighter-rouge">**</code> e em it√°lico, entre <code class="language-plaintext highlighter-rouge">_</code>;</p>

<p>¬†‚Ä¢¬† express√µes matem√°ticas LaTeX podem ser feitas usando a mesma sintaxe LaTeX, desde que estejam entre <code class="language-plaintext highlighter-rouge">$</code>;</p>

<p>¬†‚Ä¢¬† para incluir uma imagem no meio do texto siga o modelo de marca√ß√£o: <code class="language-plaintext highlighter-rouge">![t√≠tulo opcional](img/image.png)</code>;</p>

<p>¬†‚Ä¢¬† para incluir uma palavra/frase redirecion√°vel: <code class="language-plaintext highlighter-rouge">[palavra/texto](link)</code>.</p>

<p>Quanto aos <em>chunks</em>, eles s√£o blocos de c√≥digos que podem ser adicionados por meio do bot√£ozinho verde contendo a letra C e um sinal de + (√† esquerda do bot√£o <strong>Run</strong>, na janela de <em>script</em>) ou pelo atalho <code class="language-plaintext highlighter-rouge">Ctrl + Alt + I</code> no Linux ou Windows ou <code class="language-plaintext highlighter-rouge">Command + Option + I</code> no Mac. Quando renderizados, eles s√£o adicionados ao arquivo <em>markdown</em> (.md) via pacote <code class="language-plaintext highlighter-rouge">{knitr}</code>, que executa os c√≥digos dos <em>chunks</em> e gera-os em .md. Em seguida, o pacote <code class="language-plaintext highlighter-rouge">{pandoc}</code> converte o arquivo .md para a linguagem de programa√ß√£o (neste caso, o R) e no formato de arquivo (neste caso, HTML) escolhidos. N√£o se preocupe se os dois pacotes mencionados n√£o estiverem instalados, o R far√° quest√£o de avis√°-lo sobre esse contratempo. Al√©m disso, nos <em>chunks</em> existem uma s√©rie de alternativas que permitem ao usu√°rio controlar a execu√ß√£o e os resultados dos c√≥digos, tais como:</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">echo = FALSE</code>: n√£o exibir o c√≥digo (TRUE, caso contr√°rio);</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">eval = FALSE</code>: n√£o executar o c√≥digo (TRUE, caso contr√°rio);</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">message = FALSE</code>: esconder mensagens geradas pelo c√≥digo (TRUE, caso contr√°rio);</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">fig.height = 10</code>: estipular a altura de uma figura (valor em polegadas);</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">fig.width = 10</code>: estipular a largura de uma figura (valor em polegadas);</p>

<p>¬†‚Ä¢¬† <code class="language-plaintext highlighter-rouge">fig.align = 'center'</code>: centralizar uma imagem.</p>

<p>√â sugerido ler a se√ß√£o <a href="https://bookdown.org/yihui/rmarkdown/markdown-syntax.html">2.5 Markdown syntax</a> se a inten√ß√£o √© conhecer o conjunto de sintaxes dispon√≠vel para RMarkdown e a se√ß√£o <a href="https://bookdown.org/yihui/rmarkdown/r-code.html">2.6 R code chunks and inline R code</a> para ver a gama de op√ß√µes que est√° a servi√ßo dos <em>chunks</em>.</p>

<p>Vamos ver como isso funciona na pr√°tica ao dar continuidade √†quele arquivo .Rmd que criamos alguns par√°grafos atr√°s.</p>

<p><img src="/assets/images/posts/Relat√≥rios-com-R-Markdown/fig3.png" alt="imagem" /></p>

<p>Em nosso ‚Äúmini relat√≥rio‚Äù, vejam que redigimos um pequeno texto como introdu√ß√£o igualmente como fazemos em editores de texto como o Word e Google Docs, por exemplo. J√° para dar in√≠cio √† se√ß√£o ‚ÄúOs dados‚Äù, utilizamos o marcador <code class="language-plaintext highlighter-rouge">###</code>. No entanto, a aten√ß√£o mesmo fica por conta do <em>chunk</em>, para o qual demos o nome de ‚Äúdados‚Äù - nomear um <em>chunk</em> √© muito importante para identificar erros, a prop√≥sito. Neste caso, informamos que o c√≥digo fosse avaliado e mostrado no relat√≥rio e que mensagens e alertas fossem omitidos.</p>

<p>Agora reparem na pr√≥xima se√ß√£o e nos <em>chunks</em> correspondentes.</p>

<p><img src="/assets/images/posts/Relat√≥rios-com-R-Markdown/fig4.png" alt="imagem" /></p>

<p>Aqui, dividimos a se√ß√£o ‚ÄúAn√°lise‚Äù em duas abas, em que numa tem uma tabela cruzada entre ra√ßa e classifica√ß√£o e na outra, um gr√°fico de barras. A forma de fazer isso √© muito simples, com o c√≥digo HTML <code class="language-plaintext highlighter-rouge">{.tabset}</code>, mas o resultado √© fant√°stico! Bom, mas voltando √†s configura√ß√µes dos <em>chunks</em>, observem que dessa vez preferimos n√£o apresentar os c√≥digos, al√©m de que o gr√°fico fosse centralizado.</p>

<p>Terminado o relat√≥rio, o que precisamos fazer agora √© renderizar nosso arquivo .Rmd para que ele seja convertido em um arquivo HTML, que foi o formato de <em>output</em> que escolhemos l√° no in√≠cio. Fazemos isso ao utilizar o atalho <code class="language-plaintext highlighter-rouge">Ctrl + Shift + K</code> no Linux ou Windows ou <code class="language-plaintext highlighter-rouge">Command + Shift + K</code> no Mac ou simplesmente clicando no bot√£o <strong>Knit</strong> (que est√° acompanhado por um novelo de l√£ azul). Na realidade, √© recomend√°vel que a cada <em>chunk</em> constru√≠do seja feita a renderiza√ß√£o do documento, principalmente se o seu relat√≥rio for muito extenso e com muitos <em>chunks</em>. Dessa forma, √© poss√≠vel acompanhar se o resultado est√° ficando ao seu agrado como tamb√©m fica mais f√°cil identificar poss√≠veis erros.</p>

<p>Ap√≥s ‚Äúdar knit‚Äù em nosso RMarkdown, o relat√≥rio em HTML gerado √© o que est√° na figura abaixo.</p>

<p><img src="/assets/images/posts/Relat√≥rios-com-R-Markdown/fig5.png" alt="imagem" /></p>

<p>Legal, n√©?</p>

<p>Ainda que de forma simples, mostramos como o RMarkdown pode conectar o documentar, o compartilhar e o comunicar dos dados de maneira pr√°tica e sem dar maiores dores de cabe√ßa ao usu√°rio (pois olhem s√≥, propusemos um relat√≥rio em HTML sem precisar ter qualquer no√ß√£o de HTML!). Al√©m do mais, sua flexibilidade em se adequar aos diferentes tipos de linguagem de programa√ß√£o e formato de arquivo consegue agradar aos mais diversos perfis de profissionais, mesmo aqueles com pouca experi√™ncia em programa√ß√£o.</p>

<p>A √∫ltima e grande not√≠cia √© que o RMarkdown n√£o se limita a um relat√≥rio est√°tico com c√≥digos e respectivos resultados. Com ele, tamb√©m √© poss√≠vel fazer trabalhos acad√™micos, artigos, curr√≠culos profissionais, correio personalizado (encaminhar documentos em PDF automaticamente), slides, livros (o livro <a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide</a>, recomendado mais de uma vez neste post, √© todo feito em? RMarkdown!), pain√©is interativos (geralmente por meio do pacote <code class="language-plaintext highlighter-rouge">{flexdashboard}</code>)‚Ä¶ No bom sentido da express√£o, o que foi mostrado aqui foi s√≥ a pontinha do <em>iceberg</em>!</p>
:ET